function CheckTrip(e, t) { if (e != "" && t != "") { var n = e.split(","); var r = t.split(","); if (n[1] == "IN" && r[1] == "IN") { Trip = "D" } else { Trip = "I" } } } var SHandler; $(document).ready(function() { SHandler = new SearchHelper; SHandler.BindEvents() }); $(document).ready(function() { var e = $("input[name='TripType']:checked").val(); if (e == "rdbOneWay") { $("#trRetDateRow").hide() } else { $("#trRetDateRow").show() } }); var Trip; var SearchHelper = function() { this.flight = $("flight"); this.txtDepCity1 = $("#txtDepCity1"); this.txtArrCity1 = $("#txtArrCity1"); this.btnSearch = $("#btnSearch"); this.hidtxtDepCity1 = $("#hidtxtDepCity1"); this.hidtxtArrCity1 = $("#hidtxtArrCity1"); this.hidAirline = $("#hidAirLine"); this.rdbOneWay = $("#rdbOneWay"); this.rdbRoundTrip = $("#rdbRoundTrip"); this.txtDepDate = $("#txtDepDate"); this.txtRetDate = $("#txtRetDate"); this.hidtxtDepDate = $("#hidtxtDepDate"); this.hidtxtRetDate = $("#hidtxtRetDate"); this.trRetDateRow = $("#trRetDateRow"); this.TripType = $("input[name=TripType]"); this.Adult = $("#Adult"); this.Child = $("#Child"); this.Infant = $("#Infant"); this.Cabin = $("#Cabin"); this.txtAirline = $("#txtAirline"); this.hidtxtAirline = $("#hidtxtAirline"); this.chkNonstop = $("#chkNonstop"); this.chkAdvSearch = $("#chkAdvSearch"); this.trAdvSearchRow = $("#trAdvSearchRow"); this.LCC_RTF = $("#LCC_RTF"); this.GDS_RTF = $("#GDS_RTF"); this.showresult1 = $("#showresult1"); this.showresult2 = $("#showresult2"); this.showresult3 = $("#showresult3"); this.AirIndia = $("#AI"); this.JetAirways = $("#9W"); this.JetKonnect = $("#S2"); this.Kingfisher = $("#IT"); this.Spicejet = $("#SG") }; SearchHelper.prototype.BindEvents = function() { var e = this; var t = e.hidtxtDepDate.val(); var n = e.hidtxtRetDate.val(); var r = { numberOfMonths: 2, dateFormat: "dd/mm/yy", maxDate: "+1y", minDate: 0, showOtherMonths: true, selectOtherMonths: false }; e.txtDepDate.datepicker(r).datepicker("option", { onSelect: e.UpdateRoundTripMininumDate }).datepicker("setDate", t.substr(0, 10)); e.txtRetDate.datepicker(r).datepicker("setDate", n.substr(0, 10)); var i = UrlBase + "CitySearch.asmx/FetchCityList"; e.txtDepCity1.autocomplete({ source: function(e, t) { $.ajax({ url: i, data: "{ 'city': '" + e.term + "', maxResults: 10 }", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", success: function(e) { t($.map(e.d, function(e) { var t = e.CityName + "(" + e.AirportCode + ")"; var n = e.AirportCode + "," + e.CountryCode; return { label: t, value: t, id: n} })) }, error: function(e, t, n) { alert(t) } }) }, autoFocus: true, minLength: 3, select: function(t, n) { e.hidtxtDepCity1.val(n.item.id) } }); e.txtArrCity1.autocomplete({ source: function(e, t) { $.ajax({ url: i, data: "{ 'city': '" + e.term + "', maxResults: 10 }", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", success: function(e) { t($.map(e.d, function(e) { var t = e.CityName + "(" + e.AirportCode + ")"; var n = e.AirportCode + "," + e.CountryCode; return { label: t, value: t, id: n} })) }, error: function(e, t, n) { alert(t) } }) }, autoFocus: true, minLength: 3, select: function(t, n) { e.hidtxtArrCity1.val(n.item.id) } }); var s = UrlBase + "CitySearch.asmx/FetchAirlineList"; e.txtAirline.autocomplete({ source: function(e, t) { $.ajax({ url: s, data: "{ 'airline': '" + e.term + "', maxResults: 10 }", dataType: "json", type: "POST", contentType: "application/json; charset=utf-8", success: function(e) { t($.map(e.d, function(e) { var t = e.ALName + "(" + e.ALCode + ")"; var n = e.ALName + "," + e.ALCode; return { label: t, value: t, id: n} })) }, error: function(e, t, n) { alert(t) } }) }, autoFocus: true, minLength: 3, select: function(t, n) { e.hidtxtAirline.val(n.item.id) } }); e.TripType.click(function() { if ($(this).val() == "rdbOneWay" || $(this).val() == "rdbRoundTrip") { if ($(this).val() == "rdbRoundTrip") { e.UpdateRoundTripMininumDate(e.txtDepDate.val()); e.trRetDateRow.show() } else { e.trRetDateRow.hide() } } else { } }); e.chkAdvSearch.click(function() { if ($(this).is(":checked")) { if (e.hidtxtDepCity1.val() != "" && e.hidtxtArrCity1.val() != "") { var t = e.hidtxtDepCity1.val().split(","); var n = e.hidtxtArrCity1.val().split(","); if (t[1] == "IN" && n[1] == "IN") { e.chkAdvSearch.attr("value", true) } else { e.chkAdvSearch.attr("value", false); alert("Only for Domestic Search"); return false } } else { e.chkAdvSearch.attr("value", false); alert("Please Select Origin And Destination"); return false } } else { e.chkAdvSearch.attr("value", false) } }); e.GDS_RTF.click(function() { if ($(this).is(":checked")) { if (e.hidtxtDepCity1.val() != "" && e.hidtxtArrCity1.val() != "") { var t = e.hidtxtDepCity1.val().split(","); var n = e.hidtxtArrCity1.val().split(","); if (t[1] == "IN" && n[1] == "IN") { e.GDS_RTF.attr("value", true); e.LCC_RTF.attr("value", false); e.LCC_RTF.attr("checked", false) } else { e.GDS_RTF.attr("value", false); e.LCC_RTF.attr("value", false); alert("Only for Domestic Search"); return false } } else { e.GDS_RTF.attr("value", false); alert("Please Select Origin And Destination"); return false } } else { e.GDS_RTF.attr("value", false) } }); e.LCC_RTF.click(function() { if ($(this).is(":checked")) { if (e.hidtxtDepCity1.val() != "" && e.hidtxtArrCity1.val() != "") { var t = e.hidtxtDepCity1.val().split(","); var n = e.hidtxtArrCity1.val().split(","); if (t[1] == "IN" && n[1] == "IN") { e.GDS_RTF.attr("value", false); e.LCC_RTF.attr("value", true); e.GDS_RTF.attr("checked", false) } else { e.GDS_RTF.attr("value", false); e.LCC_RTF.attr("value", false); alert("Only for Domestic Search"); return false } } else { e.LCC_RTF.attr("value", false); alert("Please Select Origin And Destination"); return false } } else { e.LCC_RTF.attr("value", false) } }); e.btnSearch.click(function() { return e.validate() }) }; SearchHelper.prototype.UpdateRoundTripMininumDate = function(e, t) { SHandler.txtRetDate.datepicker("option", { minDate: e }) }; SearchHelper.prototype.validate = function() { var e = this; var t = $("input[name='TripType']:checked").val(); CheckTrip(e.hidtxtDepCity1.val(), e.hidtxtArrCity1.val()); if (t == "rdbOneWay" || t == "rdbRoundTrip") { if ($.trim(e.txtDepCity1.val()) == "") { alert("Origin Required."); e.txtDepCity1.val("").focus(); return false } else if (e.hidtxtDepCity1.val() == "") { alert("Invalid Origin."); e.txtDepCity1.val("").focus(); return false } if ($.trim(e.txtArrCity1.val()) == "") { alert("Destination Required."); e.txtArrCity1.val("").focus(); return false } else if (e.hidtxtArrCity1.val() == "") { alert("Invalid Destination."); e.txtArrCity1.val("").focus(); return false } if (e.txtDepDate.val() == "" || e.txtDepDate.val() == null) { alert("Departure Date Required."); return false } if (t == "rdbRoundTrip") { if (e.txtRetDate.val() == "" || e.txtRetDate.val() == null) { alert("Return Date Required."); return false } var n = ChangeDateFormat(e.txtDepDate.val()); var r = ChangeDateFormat(e.txtRetDate.val()); if (r < n) { alert("Return Date Should Be Greater Than Departure Date."); return false } } if (e.LCC_RTF.attr("checked") == true && t != "rdbRoundTrip") { e.LCC_RTF.attr("checked", false); alert("Please select round trip."); return false } if (e.GDS_RTF.attr("checked") == true && t != "rdbRoundTrip") { e.GDS_RTF.attr("checked", false); alert("Please select round trip."); return false } } else { return false } var i = parseInt(e.Adult.val()); var s = parseInt(e.Child.val()); var o = parseInt(e.Infant.val()); var u = i + s; if (u > 9) { alert("Total Number Of Passenger Should Be Less Than 9."); return false } if (o > i) { alert("Number Of Infant Should Be Less Than Or Equal To Number Of Adult"); return false } if (e.txtAirline.val() != "") { if (e.hidtxtAirline.val() == "") { alert("Invalid Airline"); e.txtAirline.val("").focus(); return false } } e.StartSearch() }; SearchHelper.prototype.StartSearch = function() { var e = this; var t = $("input[name='TripType']:checked").val(); var n; var r; var i; if (e.LCC_RTF.attr("checked") == true) { n = "TRUE" } else { n = "FALSE" } if (e.GDS_RTF.attr("checked") == true) { r = "TRUE" } else { r = "FALSE" } if (e.chkNonstop.attr("checked") == true) { i = "TRUE" } else { i = "FALSE" } var s = "TripType=" + t + "&txtDepCity1=" + e.txtDepCity1.val() + "&txtArrCity1=" + e.txtArrCity1.val() + "&hidtxtDepCity1=" + e.hidtxtDepCity1.val() + "&hidtxtArrCity1=" + e.hidtxtArrCity1.val() + "&Adult=" + e.Adult.val(); s += "&Child=" + e.Child.val() + "&Infant=" + e.Infant.val() + "&Cabin=" + e.Cabin.val() + "&txtAirline=" + e.txtAirline.val() + "&hidtxtAirline=" + e.hidtxtAirline.val() + "&txtDepDate=" + e.txtDepDate.val() + "&txtRetDate=" + e.txtRetDate.val() + "&RTF=" + n + "&NStop=" + i + "&RTF=" + n + "&Trip=" + Trip + "&GRTF=" + r; document.getElementById("__VIEWSTATE").name = "NOVIEWSTATE"; if (Trip == "D") { window.location.href = UrlBase + "Domestic/Result.aspx?" + s; } else if (Trip == "I") { window.location.href = UrlBase + "International/FltResIntl.aspx?" + s; } }
